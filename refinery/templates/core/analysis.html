{% extends "base.html" %}

{% block title %}
{{ block.super }} - Analysis {{ analysis.name }}
{% endblock %}

{% block subheader %}
 Analysis: <i>{{ analysis.name }}</i>
{% endblock %}

{% block content %}
<div class="label">Summary</div>
<p>{{analysis.summary}}</p>

<div class="label">Workflow</div>
<p>{{workflow.name}}</p>

<div class="label">Analysis Inputs</div>
<ul>
{% for input in inputs.all %}
	<li><p>Workflow Input Name: {{input.workflow_data_input_name}}</p></li>
{% endfor %}
</ul>

<div class="label">Analysis Outputs</div>

<div class = "row-fluid">
	<form action="/visualization_manager/igv_result/" method="post" id="sampleForm">
	{% csrf_token %}
	
	<table class="table table-striped table-bordered table-condensed table-hover" id="samples1">
	<thead><tr><th>Select</th><th>File</th><th>Size</th><th>Visualize</th></tr></thead>

	<tbody>
	
	{% for result in analysis_results.all %}
		<tr>
		{% for fs in fs_files %}	
			{% ifequal result.file_store_uuid fs.uuid %}
				<td>
				{% if result.file_type|lower == 'igv.tdf' or result.file_type|lower == 'wig' %}
					<input type="checkbox" name="igv_{{fs.uuid}}" id="{{fs.uuid}}" class="case"/>
				{% endif %}
				</td>
			
				<td>
					<a href="{{fs.get_url}}">{{result.file_name}}</a>
				</td>
				
				<td>
					{{fs.get_file_size|filesizeformat}}
				</td>
				
				{% endifequal %}
			{% endfor %}
			
			<td>
			{% if result.file_type|lower == 'igv.tdf' %}
				{#: <a href="/file_server/profile_viewer/{{result.file_store_uuid}}/chr4/1/1000000/">Visualize</a>#}
				: <a href="/file_server/profile_viewer/{{result.file_store_uuid}}/chr19/3000000/10000000/">Visualize</a>
			{% endif %}
			</td>
		</tr>
	{% endfor %}


	</tbody>	
	</table>
	</div>
	
	<div class = "row-fluid">
		<button class="btn" id="submitIGV"> 
			<i class="icon-road"></i> IGV
	 	</button>
	</div>
	</form>


{% endblock %}

{% block script %}

	<script>
	/*
	
	// validate form inputs: To ensure a workflow is chosen
	$("#submitIGV").click( function() {
		//event.preventDefault(); // cancel default behavior
				
		$.ajax({
			url : "/visualization_manager/igv_result/",
			type : "POST",
			dataType : "json",
			data : {
				csrfmiddlewaretoken : "{{ csrf_token }}"
			},
			success : function(result) {
				console.log(result);

				alert("IGV CALLED");
			}
		});
		});
		*/
		
  	</script>
  	


{% endblock %}
